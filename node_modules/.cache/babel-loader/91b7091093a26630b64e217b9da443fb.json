{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction reducerWithInitialState(initialState) {\n  return makeReducer(initialState);\n}\n\nexports.reducerWithInitialState = reducerWithInitialState;\n\nfunction reducerWithoutInitialState() {\n  return makeReducer();\n}\n\nexports.reducerWithoutInitialState = reducerWithoutInitialState;\n\nfunction upcastingReducer() {\n  return makeReducer();\n}\n\nexports.upcastingReducer = upcastingReducer;\n\nfunction makeReducer(initialState) {\n  var handlersByActionType = {};\n  var reducer = getReducerFunction(initialState, handlersByActionType);\n\n  reducer.caseWithAction = function (actionCreator, handler) {\n    handlersByActionType[actionCreator.type] = handler;\n    return reducer;\n  };\n\n  reducer.case = function (actionCreator, handler) {\n    return reducer.caseWithAction(actionCreator, function (state, action) {\n      return handler(state, action.payload);\n    });\n  };\n\n  reducer.casesWithAction = function (actionCreators, handler) {\n    for (var _i = 0, actionCreators_1 = actionCreators; _i < actionCreators_1.length; _i++) {\n      var actionCreator = actionCreators_1[_i];\n      reducer.caseWithAction(actionCreator, handler);\n    }\n\n    return reducer;\n  };\n\n  reducer.cases = function (actionCreators, handler) {\n    return reducer.casesWithAction(actionCreators, function (state, action) {\n      return handler(state, action.payload);\n    });\n  };\n\n  reducer.withHandling = function (updateBuilder) {\n    return updateBuilder(reducer);\n  };\n\n  reducer.default = function (defaultHandler) {\n    return getReducerFunction(initialState, __assign({}, handlersByActionType), defaultHandler);\n  };\n\n  reducer.build = function () {\n    return getReducerFunction(initialState, __assign({}, handlersByActionType));\n  };\n\n  return reducer;\n}\n\nfunction getReducerFunction(initialState, handlersByActionType, defaultHandler) {\n  return function (state, action) {\n    if (state === void 0) {\n      state = initialState;\n    }\n\n    var handler = handlersByActionType[action.type] || defaultHandler;\n    return handler ? handler(state, action) : state;\n  };\n}","map":{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AA8FA,SAAgB,uBAAhB,CAA2C,YAA3C,EAA0D;AACtD,SAAO,WAAW,CAAO,YAAP,CAAlB;AACH;;AAFD,OAAA,CAAA,uBAAA,GAAA,uBAAA;;AAIA,SAAgB,0BAAhB,GAA0C;AACtC,SAAO,WAAW,EAAlB;AACH;;AAFD,OAAA,CAAA,0BAAA,GAAA,0BAAA;;AAIA,SAAgB,gBAAhB,GAAgC;AAI5B,SAAO,WAAW,EAAlB;AACH;;AALD,OAAA,CAAA,gBAAA,GAAA,gBAAA;;AAOA,SAAS,WAAT,CACI,YADJ,EACsB;AAElB,MAAM,oBAAoB,GAEtB,EAFJ;AAGA,MAAM,OAAO,GAAG,kBAAkB,CAC9B,YAD8B,EAE9B,oBAF8B,CAAlC;;AAKA,EAAA,OAAO,CAAC,cAAR,GAAyB,UACrB,aADqB,EAErB,OAFqB,EAEiB;AAEtC,IAAA,oBAAoB,CAAC,aAAa,CAAC,IAAf,CAApB,GAA2C,OAA3C;AACA,WAAO,OAAP;AACH,GAND;;AAQA,EAAA,OAAO,CAAC,IAAR,GAAe,UACX,aADW,EAEX,OAFW,EAEmB;AAE9B,WAAA,OAAO,CAAC,cAAR,CAAuB,aAAvB,EAAsC,UAAC,KAAD,EAAQ,MAAR,EAAc;AAChD,aAAA,OAAO,CAAC,KAAD,EAAQ,MAAM,CAAC,OAAf,CAAP;AAA8B,KADlC,CAAA;AAEC,GANL;;AAQA,EAAA,OAAO,CAAC,eAAR,GAA0B,UACtB,cADsB,EAEtB,OAFsB,EAEgB;AAEtC,SAA4B,IAAA,EAAA,GAAA,CAAA,EAAA,gBAAA,GAAA,cAA5B,EAA4B,EAAA,GAAA,gBAAA,CAAA,MAA5B,EAA4B,EAAA,EAA5B,EAA4C;AAAvC,UAAM,aAAa,GAAA,gBAAA,CAAA,EAAA,CAAnB;AACD,MAAA,OAAO,CAAC,cAAR,CAAuB,aAAvB,EAAsC,OAAtC;AACH;;AACD,WAAO,OAAP;AACH,GARD;;AAUA,EAAA,OAAO,CAAC,KAAR,GAAgB,UACZ,cADY,EAEZ,OAFY,EAEkB;AAE9B,WAAA,OAAO,CAAC,eAAR,CAAwB,cAAxB,EAAwC,UAAC,KAAD,EAAQ,MAAR,EAAc;AAClD,aAAA,OAAO,CAAC,KAAD,EAAQ,MAAM,CAAC,OAAf,CAAP;AAA8B,KADlC,CAAA;AAEC,GANL;;AAQA,EAAA,OAAO,CAAC,YAAR,GAAuB,UACnB,aADmB,EAGW;AAC7B,WAAA,aAAa,CAAb,OAAa,CAAb;AAAsB,GAJ3B;;AAMA,EAAA,OAAO,CAAC,OAAR,GAAkB,UAAC,cAAD,EAA8C;AAC5D,WAAA,kBAAkB,CACd,YADc,EACF,QAAA,CAAA,EAAA,EACP,oBADO,CADE,EAGd,cAHc,CAAlB;AAIC,GALL;;AAOA,EAAA,OAAO,CAAC,KAAR,GAAgB,YAAA;AACZ,WAAA,kBAAkB,CAAC,YAAD,EAAa,QAAA,CAAA,EAAA,EAAO,oBAAP,CAAb,CAAlB;AAA6D,GADjE;;AAGA,SAAO,OAAP;AACH;;AAED,SAAS,kBAAT,CACI,YADJ,EAEI,oBAFJ,EAGI,cAHJ,EAGkD;AAE9C,SAAO,UAAC,KAAD,EAA8B,MAA9B,EAA+C;AAA9C,QAAA,KAAA,KAAA,KAAA,CAAA,EAAA;AAAA,MAAA,KAAA,GAAQ,YAAR;AAA2B;;AAC/B,QAAM,OAAO,GAAG,oBAAoB,CAAC,MAAM,CAAC,IAAR,CAApB,IAAqC,cAArD;AACA,WAAO,OAAO,GAAG,OAAO,CAAC,KAAD,EAAQ,MAAR,CAAV,GAA4B,KAA1C;AACH,GAHD;AAIH","sourcesContent":["import { Action, ActionCreator, AnyAction } from \"typescript-fsa\";\n\nexport interface ReducerBuilder<InS extends OutS, OutS = InS> {\n    case<P>(\n        actionCreator: ActionCreator<P>,\n        handler: Handler<InS, OutS, P>,\n    ): ReducerBuilder<InS, OutS>;\n    caseWithAction<P>(\n        actionCreator: ActionCreator<P>,\n        handler: Handler<InS, OutS, Action<P>>,\n    ): ReducerBuilder<InS, OutS>;\n\n    // cases variadic overloads\n    cases<P1>(\n        actionCreators: [ActionCreator<P1>],\n        handler: Handler<InS, OutS, P1>,\n    ): ReducerBuilder<InS, OutS>;\n    cases<P1, P2>(\n        actionCreators: [ActionCreator<P1>, ActionCreator<P2>],\n        handler: Handler<InS, OutS, P1 | P2>,\n    ): ReducerBuilder<InS, OutS>;\n    cases<P1, P2, P3>(\n        actionCreators: [\n            ActionCreator<P1>,\n            ActionCreator<P2>,\n            ActionCreator<P3>\n        ],\n        handler: Handler<InS, OutS, P1 | P2 | P3>,\n    ): ReducerBuilder<InS, OutS>;\n    cases<P1, P2, P3, P4>(\n        actionCreators: [\n            ActionCreator<P1>,\n            ActionCreator<P2>,\n            ActionCreator<P3>,\n            ActionCreator<P4>\n        ],\n        handler: Handler<InS, OutS, P1 | P2 | P3 | P4>,\n    ): ReducerBuilder<InS, OutS>;\n    cases<P>(\n        actionCreators: Array<ActionCreator<P>>,\n        handler: Handler<InS, OutS, P>,\n    ): ReducerBuilder<InS, OutS>;\n\n    // casesWithAction variadic overloads\n    casesWithAction<P1>(\n        actionCreators: [ActionCreator<P1>],\n        handler: Handler<InS, OutS, Action<P1>>,\n    ): ReducerBuilder<InS, OutS>;\n    casesWithAction<P1, P2>(\n        actionCreators: [ActionCreator<P1>, ActionCreator<P2>],\n        handler: Handler<InS, OutS, Action<P1 | P2>>,\n    ): ReducerBuilder<InS, OutS>;\n    casesWithAction<P1, P2, P3>(\n        actionCreators: [\n            ActionCreator<P1>,\n            ActionCreator<P2>,\n            ActionCreator<P3>\n        ],\n        handler: Handler<InS, OutS, Action<P1 | P2 | P3>>,\n    ): ReducerBuilder<InS, OutS>;\n    casesWithAction<P1, P2, P3, P4>(\n        actionCreators: [\n            ActionCreator<P1>,\n            ActionCreator<P2>,\n            ActionCreator<P3>,\n            ActionCreator<P4>\n        ],\n        handler: Handler<InS, OutS, Action<P1 | P2 | P3 | P4>>,\n    ): ReducerBuilder<InS, OutS>;\n    casesWithAction<P>(\n        actionCreators: Array<ActionCreator<P>>,\n        handler: Handler<InS, OutS, Action<P>>,\n    ): ReducerBuilder<InS, OutS>;\n\n    withHandling(\n        updateBuilder: (\n            builder: ReducerBuilder<InS, OutS>,\n        ) => ReducerBuilder<InS, OutS>,\n    ): ReducerBuilder<InS, OutS>;\n\n    // Intentionally avoid AnyAction in return type so packages can export reducers\n    // created using .default() or .build() without requiring a dependency on typescript-fsa.\n    default(\n        defaultHandler: Handler<InS, OutS, AnyAction>,\n    ): (state: InS | undefined, action: { type: any }) => OutS;\n    build(): (state: InS | undefined, action: { type: any }) => OutS;\n    (state: InS | undefined, action: AnyAction): OutS;\n}\n\nexport type Handler<InS extends OutS, OutS, P> = (\n    state: InS,\n    payload: P,\n) => OutS;\n\nexport function reducerWithInitialState<S>(initialState: S): ReducerBuilder<S> {\n    return makeReducer<S, S>(initialState);\n}\n\nexport function reducerWithoutInitialState<S>(): ReducerBuilder<S> {\n    return makeReducer<S, S>();\n}\n\nexport function upcastingReducer<InS extends OutS, OutS>(): ReducerBuilder<\n    InS,\n    OutS\n> {\n    return makeReducer<InS, OutS>();\n}\n\nfunction makeReducer<InS extends OutS, OutS>(\n    initialState?: InS,\n): ReducerBuilder<InS, OutS> {\n    const handlersByActionType: {\n        [actionType: string]: Handler<InS, OutS, any>;\n    } = {};\n    const reducer = getReducerFunction(\n        initialState,\n        handlersByActionType,\n    ) as ReducerBuilder<InS, OutS>;\n\n    reducer.caseWithAction = <P>(\n        actionCreator: ActionCreator<P>,\n        handler: Handler<InS, OutS, Action<P>>,\n    ) => {\n        handlersByActionType[actionCreator.type] = handler;\n        return reducer;\n    };\n\n    reducer.case = <P>(\n        actionCreator: ActionCreator<P>,\n        handler: Handler<InS, OutS, P>,\n    ) =>\n        reducer.caseWithAction(actionCreator, (state, action) =>\n            handler(state, action.payload),\n        );\n\n    reducer.casesWithAction = <P>(\n        actionCreators: Array<ActionCreator<P>>,\n        handler: Handler<InS, OutS, Action<P>>,\n    ) => {\n        for (const actionCreator of actionCreators) {\n            reducer.caseWithAction(actionCreator, handler);\n        }\n        return reducer;\n    };\n\n    reducer.cases = <P>(\n        actionCreators: Array<ActionCreator<P>>,\n        handler: Handler<InS, OutS, P>,\n    ) =>\n        reducer.casesWithAction(actionCreators, (state, action) =>\n            handler(state, action.payload),\n        );\n\n    reducer.withHandling = (\n        updateBuilder: (\n            builder: ReducerBuilder<InS, OutS>,\n        ) => ReducerBuilder<InS, OutS>,\n    ) => updateBuilder(reducer);\n\n    reducer.default = (defaultHandler: Handler<InS, OutS, AnyAction>) =>\n        getReducerFunction(\n            initialState,\n            { ...handlersByActionType },\n            defaultHandler,\n        );\n\n    reducer.build = () =>\n        getReducerFunction(initialState, { ...handlersByActionType });\n\n    return reducer;\n}\n\nfunction getReducerFunction<InS extends OutS, OutS>(\n    initialState: InS | undefined,\n    handlersByActionType: { [actionType: string]: Handler<InS, OutS, any> },\n    defaultHandler?: Handler<InS, OutS, AnyAction>,\n) {\n    return (state = initialState as InS, action: AnyAction) => {\n        const handler = handlersByActionType[action.type] || defaultHandler;\n        return handler ? handler(state, action) : state;\n    };\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}